用例ID,用例名称,测试类型,优先级,关联REQ-ID,关联功能点,测试场景,前置条件,测试步骤,预期结果,备注
TC-AUTH_LOGIN-001,用户登录成功-邮箱登录,INTEGRATION,P0,REQ-2025-003-user-login,用户登录,有效邮箱+密码+验证码登录成功,已有用户且未锁定且验证码有效,"1. 获取验证码 2. POST /api/auth/login/ 使用邮箱 3. 检查返回token与user",返回200并返回token/refresh_token与user信息,
TC-AUTH_LOGIN-002,用户登录成功-用户名登录,INTEGRATION,P1,REQ-2025-003-user-login,用户登录,使用用户名替代邮箱登录,已有用户且未锁定且验证码有效,"1. 获取验证码 2. POST /api/auth/login/ 使用用户名 3. 检查返回token",返回200并返回token/refresh_token,
TC-AUTH_LOGIN-003,用户登录失败-密码错误,INTEGRATION,P1,REQ-2025-003-user-login,用户登录,密码错误登录失败计数+错误信息,已有用户且验证码有效,"1. 获取验证码 2. 使用错误密码POST /api/auth/login/ 3. 检查错误响应",返回401并返回INVALID_CREDENTIALS且failed_attempts递增,
TC-AUTH_LOGIN-004,用户登录失败-验证码错误,INTEGRATION,P1,REQ-2025-003-user-login,用户登录,验证码错误导致登录失败,已有用户且验证码有效,"1. 获取验证码 2. 使用错误验证码POST /api/auth/login/ 3. 检查错误响应",返回400并返回验证码错误信息,
TC-AUTH_LOGIN-005,用户登录失败-用户不存在,INTEGRATION,P1,REQ-2025-003-user-login,用户登录,邮箱/用户名不存在时登录失败,验证码有效,"1. 获取验证码 2. 使用不存在邮箱POST /api/auth/login/ 3. 检查错误响应",返回401并返回INVALID_CREDENTIALS,
TC-AUTH_LOGIN-006,用户登录失败-未验证邮箱,INTEGRATION,P1,REQ-2025-003-user-login,用户登录,邮箱未验证时拒绝登录,已有用户但is_email_verified=false且验证码有效,"1. 获取验证码 2. POST /api/auth/login/ 3. 检查错误响应",返回403并提示需要验证邮箱,
TC-AUTH_LOGIN-007,用户登录失败-缺少必填字段,INTEGRATION,P2,REQ-2025-003-user-login,用户登录,缺少email/password/captcha时返回错误,验证码有效,"1. 获取验证码 2. POST /api/auth/login/ 缺少字段 3. 检查错误响应",返回400并返回字段缺失错误,
TC-AUTH_LOGIN-008,用户登录成功-生成JWT Token,INTEGRATION,P0,REQ-2025-003-user-login,用户登录,登录成功后生成access_token和refresh_token,已有用户且验证码有效,"1. 获取验证码 2. POST /api/auth/login/ 3. 检查返回的token格式和有效期",返回200且token格式正确且refresh_token存在,
TC-AUTH_LOCK-001,用户登录失败次数达到阈值后锁定,INTEGRATION,P0,REQ-2025-003-user-login,登录安全,连续失败触发锁定,已有用户且验证码有效,"1. 连续5次错误登录 2. 第6次尝试 3. 检查锁定状态",返回423且locked_until存在,
TC-AUTH_LOCK-002,用户登录失败-账户已锁定,INTEGRATION,P0,REQ-2025-003-user-login,登录安全,账户锁定期间拒绝登录,已有用户且账户已锁定,"1. 获取验证码 2. POST /api/auth/login/ 3. 检查错误响应",返回423并返回锁定到期时间,
TC-AUTH_LOCK-003,用户登录成功-锁定到期后自动解锁,INTEGRATION,P1,REQ-2025-003-user-login,登录安全,锁定时间到期后可以正常登录,已有用户且锁定已过期,"1. 等待锁定时间过期 2. 获取验证码 3. POST /api/auth/login/ 4. 检查登录成功",返回200且账户已解锁,
TC-AUTH_REGISTER-001,用户注册成功,INTEGRATION,P0,REQ-2025-003-user-login,用户注册,有效邮箱+强密码+验证码注册成功,验证码有效且邮箱未注册,"1. 获取验证码 2. POST /api/auth/register/ 3. 检查返回user与token",返回201并返回user/token/refresh_token,
TC-AUTH_REGISTER-002,用户注册失败-邮箱已存在,INTEGRATION,P1,REQ-2025-003-user-login,用户注册,邮箱已被注册时拒绝注册,已有用户且验证码有效,"1. 获取验证码 2. POST /api/auth/register/ 使用已存在邮箱 3. 检查错误响应",返回400并返回邮箱已存在错误,
TC-AUTH_REGISTER-003,用户注册失败-密码强度不足,INTEGRATION,P1,REQ-2025-003-user-login,用户注册,密码不符合强度要求时拒绝,验证码有效,"1. 获取验证码 2. POST /api/auth/register/ 使用弱密码 3. 检查错误响应",返回400并返回密码强度错误,
TC-AUTH_REGISTER-004,用户注册失败-密码确认不匹配,INTEGRATION,P1,REQ-2025-003-user-login,用户注册,password与password_confirm不一致时拒绝,验证码有效,"1. 获取验证码 2. POST /api/auth/register/ 密码不匹配 3. 检查错误响应",返回400并返回密码不匹配错误,
TC-AUTH_REGISTER-005,用户注册失败-验证码错误,INTEGRATION,P1,REQ-2025-003-user-login,用户注册,验证码错误时拒绝注册,验证码有效,"1. 获取验证码 2. POST /api/auth/register/ 使用错误验证码 3. 检查错误响应",返回400并返回验证码错误,
TC-AUTH_REGISTER-006,用户注册失败-验证码过期,INTEGRATION,P2,REQ-2025-003-user-login,用户注册,使用过期验证码时拒绝注册,验证码已过期,"1. 获取验证码 2. 等待5分钟过期 3. POST /api/auth/register/ 4. 检查错误响应",返回400并返回验证码过期错误,
TC-AUTH_REGISTER-007,用户注册成功-创建用户字段正确,INTEGRATION,P0,REQ-2025-003-user-login,用户注册,注册后用户字段和默认值正确,验证码有效,"1. 获取验证码 2. POST /api/auth/register/ 3. 检查数据库用户字段",用户创建成功且字段默认值正确,
TC-AUTH_CAPTCHA-001,验证码生成与存储,UNIT,P0,REQ-2025-003-user-login,动态验证码,生成验证码图片与答案并存储,无,"1. 调用generate_captcha 2. 验证返回图片base64 3. 验证答案长度与字符集",返回captcha_id/image/answer且满足格式,
TC-AUTH_CAPTCHA-002,验证码验证功能,UNIT,P0,REQ-2025-003-user-login,动态验证码,验证码答案验证逻辑,验证码已存储,"1. 生成并存储验证码 2. 调用verify_captcha 3. 检查验证结果",正确答案返回true错误答案返回false,
TC-AUTH_CAPTCHA-003,验证码过期机制,UNIT,P1,REQ-2025-003-user-login,动态验证码,验证码5分钟后自动过期,验证码已存储,"1. 生成并存储验证码 2. 等待5分钟 3. 尝试验证 4. 检查过期",验证码过期后验证失败,
TC-AUTH_CAPTCHA-004,验证码API获取与刷新,INTEGRATION,P1,REQ-2025-003-user-login,动态验证码,获取验证码并刷新得到新captcha_id,无,"1. GET /api/auth/captcha/ 2. POST /api/auth/captcha/refresh/ 3. 比较id变化",返回200且refresh后captcha_id变化,
TC-AUTH_EMAIL-001,发送邮箱验证邮件,INTEGRATION,P1,REQ-2025-003-user-login,邮箱验证,登录后发送验证邮件,已登录且token有效,"1. 登录获取token 2. POST /api/auth/email/verify/send/ 3. 检查响应",返回200并提示已发送,
TC-AUTH_EMAIL-002,发送邮箱验证邮件-需要认证,INTEGRATION,P1,REQ-2025-003-user-login,邮箱验证,未登录时发送验证邮件被拒绝,无,"1. POST /api/auth/email/verify/send/ 无token 2. 检查错误响应",返回401未授权,
TC-AUTH_EMAIL-003,发送邮箱验证邮件-创建验证记录,INTEGRATION,P1,REQ-2025-003-user-login,邮箱验证,发送邮件时创建EmailVerification记录,已登录且token有效,"1. 登录获取token 2. POST /api/auth/email/verify/send/ 3. 检查数据库记录",EmailVerification记录已创建,
TC-AUTH_EMAIL-004,验证邮箱链接成功,INTEGRATION,P0,REQ-2025-003-user-login,邮箱验证,点击验证链接验证邮箱,EmailVerification记录存在且未过期,"1. 获取验证token 2. GET /api/auth/email/verify/{token}/ 3. 检查用户状态",返回200且is_email_verified=true,
TC-AUTH_EMAIL-005,验证邮箱链接失败-无效token,INTEGRATION,P1,REQ-2025-003-user-login,邮箱验证,使用无效token验证失败,无,"1. GET /api/auth/email/verify/invalid-token/ 2. 检查错误响应",返回400并返回token无效错误,
TC-AUTH_EMAIL-006,验证邮箱链接失败-token过期,INTEGRATION,P1,REQ-2025-003-user-login,邮箱验证,使用过期token验证失败,EmailVerification记录已过期,"1. 创建过期记录 2. GET /api/auth/email/verify/{expired-token}/ 3. 检查错误响应",返回400并返回token过期错误,
TC-AUTH_EMAIL-007,E2E邮箱验证流程, E2E,P2,REQ-2025-003-user-login,邮箱验证,前端触发验证邮件+完成验证跳转,服务可用且有测试邮箱/Mock,"1. 前端注册 2. 触发发送验证 3. 打开验证链接 4. 验证状态变化",页面显示验证成功且用户状态更新,
TC-AUTH_RESET-001,发送密码重置邮件,INTEGRATION,P0,REQ-2025-003-user-login,密码找回,发送重置邮件成功,验证码有效且邮箱存在,"1. 获取验证码 2. POST /api/auth/password/reset/send/ 3. 检查响应",返回200并提示已发送,
TC-AUTH_RESET-002,发送密码重置邮件-需要验证码,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,缺少验证码时拒绝发送,邮箱存在,"1. POST /api/auth/password/reset/send/ 无验证码 2. 检查错误响应",返回400并返回需要验证码,
TC-AUTH_RESET-003,发送密码重置邮件-创建重置记录,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,发送邮件时创建PasswordReset记录,验证码有效且邮箱存在,"1. 获取验证码 2. POST /api/auth/password/reset/send/ 3. 检查数据库记录",PasswordReset记录已创建,
TC-AUTH_RESET-004,重置密码成功,INTEGRATION,P0,REQ-2025-003-user-login,密码找回,使用有效token重置密码,PasswordReset记录存在且未过期,"1. 获取重置token 2. POST /api/auth/password/reset/ 3. 检查密码更新",返回200且密码已更新,
TC-AUTH_RESET-005,重置密码失败-无效token,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用无效token重置失败,无,"1. POST /api/auth/password/reset/ 使用无效token 2. 检查错误响应",返回400并返回token无效错误,
TC-AUTH_RESET-006,重置密码失败-token过期,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用过期token重置失败,PasswordReset记录已过期,"1. 创建过期记录 2. POST /api/auth/password/reset/ 3. 检查错误响应",返回400并返回token过期错误,
TC-AUTH_RESET-007,发送密码重置邮件-邮箱不存在,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用不存在的邮箱发送重置邮件,验证码有效,"1. 获取验证码 2. POST /api/auth/password/reset/send/ 使用不存在邮箱 3. 检查错误响应",返回400并返回邮箱不存在错误,
TC-AUTH_RESET-008,发送密码重置邮件-验证码错误,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用错误验证码发送重置邮件失败,邮箱存在,"1. 获取验证码 2. POST /api/auth/password/reset/send/ 使用错误验证码 3. 检查错误响应",返回400并返回验证码错误,
TC-AUTH_RESET-009,重置密码失败-已使用token,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用已使用过的token重置失败,PasswordReset记录已使用,"1. 创建已使用记录 2. POST /api/auth/password/reset/ 3. 检查错误响应",返回400并返回token已使用错误,
TC-AUTH_RESET-010,重置密码失败-密码不匹配,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,新密码与确认密码不一致时拒绝,PasswordReset记录存在且未过期,"1. 获取重置token 2. POST /api/auth/password/reset/ 密码不匹配 3. 检查错误响应",返回400并返回密码不匹配错误,
TC-AUTH_RESET-011,重置密码失败-弱密码,INTEGRATION,P1,REQ-2025-003-user-login,密码找回,使用弱密码重置失败,PasswordReset记录存在且未过期,"1. 获取重置token 2. POST /api/auth/password/reset/ 使用弱密码 3. 检查错误响应",返回400并返回密码强度错误,
TC-AUTH_RESET-012,E2E密码重置流程, E2E,P1,REQ-2025-003-user-login,密码找回,从前端完成重置并可用新密码登录,服务可用且token有效,"1. 前端发起重置 2. 打开reset链接 3. 提交新密码 4. 用新密码登录",页面提示重置成功且新密码可登录,
TC-AUTH_TOKEN-001,刷新Token成功,INTEGRATION,P1,REQ-2025-003-user-login,Token管理,使用refresh_token刷新access token,已有refresh_token,"1. 登录获取refresh_token 2. POST /api/auth/token/refresh/ 3. 检查token更新",返回200并返回新token,
TC-AUTH_TOKEN-002,刷新Token失败-无效token,INTEGRATION,P1,REQ-2025-003-user-login,Token管理,使用无效refresh_token刷新失败,无,"1. POST /api/auth/token/refresh/ 使用无效token 2. 检查错误响应",返回401并返回token无效错误,
TC-AUTH_TOKEN-003,刷新Token失败-token过期,INTEGRATION,P1,REQ-2025-003-user-login,Token管理,使用过期refresh_token刷新失败,refresh_token已过期,"1. 创建过期token 2. POST /api/auth/token/refresh/ 3. 检查错误响应",返回401并返回token过期错误,
TC-AUTH_TOKEN-004,用户登出成功,INTEGRATION,P1,REQ-2025-003-user-login,Token管理,登出使access_token失效,已登录且token有效,"1. 登录获取token 2. POST /api/auth/logout/ 3. 使用token访问受保护接口 4. 检查token失效",返回200且token已失效,
TC-AUTH_PREVIEW-001,登录预验证成功返回头像信息,INTEGRATION,P0,REQ-2025-003-user-login,登录预览头像,账号密码正确时返回valid=true与user信息,用户存在且验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 3. 检查valid与user字段",返回200且valid=true且user包含display_name/avatar字段,
TC-AUTH_PREVIEW-002,登录预验证成功-无头像返回默认,INTEGRATION,P1,REQ-2025-003-user-login,登录预览头像,用户无头像时返回默认头像信息,用户存在但无avatar且验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 3. 检查default_avatar=true",返回200且default_avatar=true且avatar_letter存在,
TC-AUTH_PREVIEW-003,登录预验证失败-密码错误,INTEGRATION,P1,REQ-2025-003-user-login,登录预览头像,密码错误时返回valid=false,用户存在且验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 使用错误密码 3. 检查valid字段",返回200且valid=false,
TC-AUTH_PREVIEW-004,登录预验证失败-用户不存在,INTEGRATION,P1,REQ-2025-003-user-login,登录预览头像,用户不存在时返回valid=false,验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 使用不存在邮箱 3. 检查valid字段",返回200且valid=false,
TC-AUTH_PREVIEW-005,登录预验证限流,INTEGRATION,P1,REQ-2025-003-user-login,登录预览头像,同IP高频预验证触发限流,同一IP连续请求,"1. 循环调用预验证接口 2. 超过阈值 3. 检查响应",返回429或按实现返回限流错误,
TC-AUTH_PREVIEW-006,登录预验证-支持用户名登录,INTEGRATION,P2,REQ-2025-003-user-login,登录预览头像,使用用户名替代邮箱进行预验证,用户存在且验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 使用用户名 3. 检查valid=true",返回200且valid=true,
TC-AUTH_PREVIEW-007,登录预验证-不增加失败计数,INTEGRATION,P2,REQ-2025-003-user-login,登录预览头像,预验证失败不增加failed_login_attempts,用户存在且验证码有效,"1. 获取验证码 2. POST /api/auth/preview/ 使用错误密码 3. 检查failed_attempts",返回200且failed_attempts未增加,
TC-AUTH_PREVIEW-008,E2E登录预览头像展示, E2E,P2,REQ-2025-003-user-login,登录预览头像,前端输入后展示头像/默认头像与淡入动画,服务可用且有测试用户,"1. 打开登录页 2. 输入邮箱密码验证码 3. 等待预览出现 4. 校验头像区域",页面出现预览组件且动画生效,
TC-AUTH_MODELS-001,用户模型字段与约束,UNIT,P2,REQ-2025-003-user-login,用户模型,用户字段/默认值/约束符合预期,无,"1. 创建用户 2. 检查默认字段值 3. 检查约束",字段默认值与约束符合预期,
TC-AUTH_MODELS-002,EmailVerification模型,UNIT,P2,REQ-2025-003-user-login,用户模型,EmailVerification模型字段和关系,无,"1. 创建EmailVerification记录 2. 检查字段和FK关系",记录创建成功且关系正确,
TC-AUTH_MODELS-003,PasswordReset模型,UNIT,P2,REQ-2025-003-user-login,用户模型,PasswordReset模型字段和关系,无,"1. 创建PasswordReset记录 2. 检查字段和FK关系",记录创建成功且关系正确,
