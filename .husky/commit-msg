#!/bin/sh

# æäº¤ä¿¡æ¯æ ¼å¼æ£€æŸ¥
commit_regex='^(feat|fix|docs|style|refactor|test|chore|ci|build|perf|revert)(\(.+\))?: .{1,50}'

# è¯»å–æäº¤ä¿¡æ¯
commit_msg=$(cat "$1")

# æ£€æŸ¥æ ¼å¼
if ! echo "$commit_msg" | grep -qE "$commit_regex"; then
    echo "âŒ æäº¤ä¿¡æ¯æ ¼å¼é”™è¯¯ï¼"
    echo ""
    echo "ğŸ“‹ æ­£ç¡®æ ¼å¼: type(scope): description"
    echo "ğŸ¯ ç±»å‹è¯´æ˜:"
    echo "  feat     - æ–°åŠŸèƒ½"
    echo "  fix      - ä¿®å¤bug"
    echo "  docs     - æ–‡æ¡£æ›´æ–°"
    echo "  style    - ä»£ç æ ¼å¼è°ƒæ•´"
    echo "  refactor - ä»£ç é‡æ„"
    echo "  test     - æµ‹è¯•ç›¸å…³"
    echo "  chore    - æ„å»º/å·¥å…·ç›¸å…³"
    echo "  ci       - CI/CDç›¸å…³"
    echo "  build    - æ„å»ºç›¸å…³"
    echo "  perf     - æ€§èƒ½ä¼˜åŒ–"
    echo "  revert   - å›æ»šæäº¤"
    echo ""
    echo "ğŸ’¡ ç¤ºä¾‹:"
    echo "  feat(auth): add user login functionality"
    echo "  fix(api): resolve authentication timeout issue"
    echo "  docs(readme): update installation instructions"
    echo ""
    echo "ğŸ” å½“å‰æäº¤ä¿¡æ¯: $commit_msg"
    exit 1
fi

# æ£€æŸ¥é•¿åº¦
if [ ${#commit_msg} -gt 500 ]; then
    echo "âŒ æäº¤ä¿¡æ¯è¿‡é•¿ï¼Œè¯·æ§åˆ¶åœ¨500å­—ç¬¦ä»¥å†…"
    echo "ğŸ” å½“å‰é•¿åº¦: ${#commit_msg} å­—ç¬¦"
    echo "ğŸ“ å½“å‰ä¿¡æ¯: $commit_msg"
    exit 1
fi

echo "âœ… æäº¤ä¿¡æ¯æ ¼å¼æ£€æŸ¥é€šè¿‡"
