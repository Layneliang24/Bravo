name: "Setup Global Environment (No Virtual Env)"
description: "å…¨å±€å®‰è£…Pythonä¾èµ–ï¼Œé¿å…è™šæ‹Ÿç¯å¢ƒç¼“å­˜é—®é¢˜"

runs:
  using: "composite"
  steps:
    - name: Setup Global Python Dependencies
      shell: bash
      run: |
        echo "ğŸŒ æ–¹æ¡ˆAï¼šå…¨å±€å®‰è£…Pythonä¾èµ–ï¼ˆæ— è™šæ‹Ÿç¯å¢ƒï¼‰"
        echo "ğŸ¯ ç›®æ ‡ï¼šéªŒè¯è™šæ‹Ÿç¯å¢ƒæ˜¯å¦æ˜¯é—®é¢˜æ ¹æº"
        echo ""

        # å®‰è£…å‰ç«¯ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰
        if [ -f "package.json" ]; then
          echo "ğŸ“¦ å®‰è£…å‰ç«¯ä¾èµ–..."
          npm ci --prefer-offline --no-audit
        fi

        # å…¨å±€å®‰è£…Pythonä¾èµ–
        echo "ğŸ å…¨å±€å®‰è£…Pythonä¾èµ–..."
        echo "â¬‡ï¸ å‡çº§pip..."
        python -m pip install --upgrade pip wheel

        echo "ğŸ“¦ å®‰è£…åŸºç¡€ä¾èµ–..."
        cd backend
        pip install -r requirements/base.txt

        echo "ğŸ“¦ å®‰è£…æµ‹è¯•ä¾èµ–..."
        pip install -r requirements/test.txt

        echo "ğŸ§ª éªŒè¯å…³é”®ä¾èµ–å®‰è£…..."
        python -c "import django_extensions, silk, debug_toolbar; print('âœ… æ‰€æœ‰å…³é”®ä¾èµ–éªŒè¯æˆåŠŸï¼')"

        cd ..
        echo "âœ… å…¨å±€ç¯å¢ƒè®¾ç½®å®Œæˆï¼æ— è™šæ‹Ÿç¯å¢ƒï¼Œæ— ç¼“å­˜é—®é¢˜ï¼"
