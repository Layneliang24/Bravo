name: ğŸš€ Gate - Comprehensive Test Suite (Parallel Optimized)

on:
  push:
    branches: [main, dev, "feature/*", "hotfix/*", "release/*"]
  pull_request:
    branches: [main, dev]
  workflow_call:
    secrets:
      CODECOV_TOKEN:
        required: false

jobs:
  # ==========================================
  # Job 1: ä¾èµ–å®‰è£…å’Œç¼“å­˜ (Dependencies Setup)
  # ==========================================
  setup-dependencies:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_DATABASE: bravo_test
          MYSQL_USER: bravo_user
          MYSQL_PASSWORD: bravo_password
          MYSQL_ROOT_PASSWORD: root_password
        options: >-
          --health-cmd="mysqladmin ping -h 127.0.0.1 -P 3306 -u root -proot_password"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=10
        ports:
          - 3306:3306
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js with Cache
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"
          cache: 'npm'
          cache-dependency-path: |
            frontend/package.json
            e2e/package.json

      - name: Setup Python with Cache
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"
          cache: 'pip'
          cache-dependency-path: backend/requirements/base.txt

      - name: Configure China Mirrors
        uses: ./.github/actions/configure-china-mirrors

      # å®‰è£…å‰ç«¯ä¾èµ–
      - name: Install Frontend Dependencies
        working-directory: ./frontend
        run: |
          echo "ğŸ“¦ å®‰è£…å‰ç«¯ä¾èµ–..."
          npm ci --prefer-offline --no-audit --ignore-scripts
          echo "âœ… å‰ç«¯ä¾èµ–å®‰è£…å®Œæˆ"
          echo "ğŸ” éªŒè¯vitestå®‰è£…..."
          npx vitest --version

      # å®‰è£…E2Eä¾èµ–
      - name: Install E2E Dependencies
        working-directory: ./e2e
        run: |
          echo "ğŸ§ª å®‰è£…E2Eæµ‹è¯•ä¾èµ–..."
          npm install --prefer-offline --no-audit --ignore-scripts
          echo "âœ… E2Eä¾èµ–å®‰è£…å®Œæˆ"

      # ç­‰å¾…MySQLå¯åŠ¨
      - name: Wait for MySQL to be ready
        run: |
          echo "â³ ç­‰å¾…MySQLå¯åŠ¨..."
          for i in {1..30}; do
            if mysqladmin ping -h 127.0.0.1 -P 3306 -u root -proot_password --silent; then
              echo "âœ… MySQLå·²å°±ç»ª"
              break
            fi
            echo "ç­‰å¾…MySQLå¯åŠ¨... ($i/30)"
            sleep 2
          done

      # é…ç½®MySQLç”¨æˆ·æƒé™
      - name: Configure MySQL user permissions
        run: |
          echo "ğŸ”§ é…ç½®MySQLç”¨æˆ·æƒé™..."
          mysql -h 127.0.0.1 -P 3306 -u root -proot_password -e "
            CREATE DATABASE IF NOT EXISTS bravo_test;
            CREATE USER IF NOT EXISTS 'bravo_user'@'%' IDENTIFIED BY 'bravo_password';
            GRANT ALL PRIVILEGES ON bravo_test.* TO 'bravo_user'@'%';
            FLUSH PRIVILEGES;
          "
          echo "âœ… MySQLç”¨æˆ·æƒé™é…ç½®å®Œæˆ"

      # å®‰è£…åç«¯ä¾èµ–
      - name: Install Backend Dependencies
        working-directory: ./backend
        run: |
          echo "ğŸ å®‰è£…åç«¯ä¾èµ–..."
          pip install --upgrade pip
          pip install -r requirements/base.txt
          pip install -r requirements/test.txt
          echo "âœ… åç«¯ä¾èµ–å®‰è£…å®Œæˆ"
          echo "ğŸ” éªŒè¯pytestå®‰è£…..."
          python -c "import pytest; print(f'pytestç‰ˆæœ¬: {pytest.__version__}')"

      # ç¼“å­˜å‰ç«¯node_modules
      - name: Cache Frontend Dependencies
        uses: actions/upload-artifact@v4
        with:
          name: frontend-node-modules
          path: frontend/node_modules
          retention-days: 1

      # ç¼“å­˜E2E node_modules
      - name: Cache E2E Dependencies
        uses: actions/upload-artifact@v4
        with:
          name: e2e-node-modules
          path: e2e/node_modules
          retention-days: 1

      # ç¼“å­˜Pythonç¯å¢ƒä¿¡æ¯
      - name: Cache Python Environment Info
        uses: actions/upload-artifact@v4
        with:
          name: python-env-info
          path: |
            ~/.cache/pip
          retention-days: 1

  # ==========================================
  # Job 2: å‰ç«¯æµ‹è¯• (Frontend Tests)
  # ==========================================
  frontend-tests:
    needs: setup-dependencies
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js with Cache
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"
          cache: 'npm'
          cache-dependency-path: frontend/package.json

      - name: Download Frontend Dependencies
        uses: actions/download-artifact@v4
        with:
          name: frontend-node-modules
          path: frontend/node_modules

      - name: Run Frontend Tests
        working-directory: ./frontend
        run: |
          echo "ğŸ§ª è¿è¡Œå‰ç«¯å•å…ƒæµ‹è¯•..."
          echo "ğŸ” æ£€æŸ¥node_modulesæ˜¯å¦å­˜åœ¨..."
          ls -la node_modules/ | head -10
          echo "ğŸ” æ£€æŸ¥vitestæ˜¯å¦å­˜åœ¨..."
          ls -la node_modules/.bin/vitest || echo "vitestä¸å­˜åœ¨ï¼Œé‡æ–°å®‰è£…ä¾èµ–..."
          if [ ! -f node_modules/.bin/vitest ]; then
            echo "ğŸ“¦ é‡æ–°å®‰è£…å‰ç«¯ä¾èµ–..."
            npm ci --prefer-offline --no-audit --ignore-scripts
          fi
          npm run test:coverage
          echo "âœ… å‰ç«¯æµ‹è¯•å®Œæˆ"

      - name: Generate Frontend Coverage
        working-directory: ./frontend
        run: |
          echo "ğŸ“Š ç”Ÿæˆå‰ç«¯è¦†ç›–ç‡æŠ¥å‘Š..."
          if [ -f "coverage/lcov.info" ]; then
            cp coverage/lcov.info ../coverage-frontend.lcov
            echo "âœ… å‰ç«¯è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆå®Œæˆ"
          else
            echo "âš ï¸ å‰ç«¯è¦†ç›–ç‡æ–‡ä»¶ä¸å­˜åœ¨"
          fi

      - name: Upload Frontend Test Results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: frontend-test-results
          path: |
            frontend/coverage/
            frontend/test-results/
            coverage-frontend.lcov
          retention-days: 7

  # ==========================================
  # Job 3: åç«¯æµ‹è¯• (Backend Tests)
  # ==========================================
  backend-tests:
    needs: setup-dependencies
    runs-on: ubuntu-latest
    timeout-minutes: 20
    
    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_ROOT_PASSWORD: root_password
          MYSQL_DATABASE: bravo_test
          MYSQL_USER: bravo_user
          MYSQL_PASSWORD: bravo_password
        options: >-
          --health-cmd="mysqladmin ping -h 127.0.0.1 -P 3306 -u root -proot_password"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=3
        ports:
          - 3306:3306


    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Python with Cache
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"
          cache: 'pip'
          cache-dependency-path: backend/requirements/base.txt

      - name: Configure China Mirrors
        uses: ./.github/actions/configure-china-mirrors

      - name: Install Backend Dependencies
        working-directory: ./backend
        run: |
          echo "ğŸ å®‰è£…åç«¯ä¾èµ–..."
          pip install --upgrade pip
          pip install -r requirements/base.txt
          pip install -r requirements/test.txt
          echo "ğŸ” éªŒè¯pytestå®‰è£…..."
          python -c "import pytest; print(f'âœ… pytest {pytest.__version__} å·²å®‰è£…')"

      - name: Wait for MySQL to be ready
        run: |
          echo "â³ ç­‰å¾…MySQLå¯åŠ¨..."
          for i in {1..30}; do
            if mysqladmin ping -h 127.0.0.1 -P 3306 -u root -proot_password --silent; then
              echo "âœ… MySQLå·²å°±ç»ª"
              break
            fi
            echo "ç­‰å¾…MySQLå¯åŠ¨... (attempt $i/30)"
            sleep 2
          done

      - name: Configure MySQL user permissions
        run: |
          echo "ğŸ”§ é…ç½®MySQLç”¨æˆ·æƒé™..."
          mysql -h 127.0.0.1 -P 3306 -u root -proot_password -e "
            CREATE DATABASE IF NOT EXISTS bravo_test;
            CREATE USER IF NOT EXISTS 'bravo_user'@'%' IDENTIFIED BY 'bravo_password';
            GRANT ALL PRIVILEGES ON bravo_test.* TO 'bravo_user'@'%';
            GRANT ALL PRIVILEGES ON \`test_%\`.* TO 'bravo_user'@'%';
            FLUSH PRIVILEGES;
          "
          echo "âœ… MySQLç”¨æˆ·æƒé™é…ç½®å®Œæˆ"

      - name: Setup Test Database
        working-directory: ./backend
        run: |
          echo "ğŸ—„ï¸ è®¾ç½®æµ‹è¯•æ•°æ®åº“..."
          python -c "
          import os, django
          os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'bravo.settings.test')
          django.setup()
          from django.db import connection
          from django.contrib.contenttypes.models import ContentType
          from django.contrib.auth.models import Group, Permission
          from django.contrib.sessions.models import Session
          from django.contrib.admin.models import LogEntry
          from apps.users.models import User
          
          print('ğŸ“‹ åˆ›å»ºæ•°æ®åº“è¡¨...')
          models_to_create = [ContentType, Group, Permission, User, Session, LogEntry]
          
          with connection.schema_editor() as schema_editor:
              for model in models_to_create:
                  if not model._meta.db_table in connection.introspection.table_names():
                      schema_editor.create_model(model)
                      print(f'âœ… Created table: {model._meta.db_table}')
                  else:
                      print(f'â­ï¸  Table already exists: {model._meta.db_table}')
          
          print('âœ… æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ')
          "
          echo "âœ… æµ‹è¯•æ•°æ®åº“è®¾ç½®å®Œæˆ"
        env:
          DATABASE_URL: mysql://bravo_user:bravo_password@mysql:3306/bravo_test
          DJANGO_SETTINGS_MODULE: bravo.settings.test

      - name: Run Backend Tests
        working-directory: ./backend
        run: |
          echo "ğŸ§ª è¿è¡Œåç«¯æµ‹è¯•..."
          python -m pytest tests/ -v --maxfail=0 --tb=short --junit-xml=test-results/backend-unit-results.xml --cov=. --cov-report=xml:coverage.xml --cov-report=html:htmlcov
          echo "âœ… åç«¯æµ‹è¯•å®Œæˆ"
        env:
          DATABASE_URL: mysql://bravo_user:bravo_password@mysql:3306/bravo_test
          DJANGO_SETTINGS_MODULE: bravo.settings.test

      - name: Generate Backend Coverage
        working-directory: ./backend
        run: |
          echo "ğŸ“Š ç”Ÿæˆåç«¯è¦†ç›–ç‡æŠ¥å‘Š..."
          if [ -f "coverage.xml" ]; then
            cp coverage.xml ../coverage-backend.xml
            echo "âœ… åç«¯è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆå®Œæˆ"
          else
            echo "âš ï¸ åç«¯è¦†ç›–ç‡æ–‡ä»¶ä¸å­˜åœ¨"
          fi

      - name: Upload Backend Test Results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: backend-test-results
          path: |
            backend/test-results/
            backend/htmlcov/
            coverage-backend.xml
          retention-days: 7

  # ==========================================
  # Job 4: E2Eæµ‹è¯• (End-to-End Tests)
  # ==========================================
  e2e-tests:
    needs: setup-dependencies
    runs-on: ubuntu-latest
    timeout-minutes: 25

    services:
      mysql:
        image: mysql:8.0
        env:
          MYSQL_DATABASE: bravo_test
          MYSQL_USER: bravo_user
          MYSQL_PASSWORD: bravo_password
          MYSQL_ROOT_PASSWORD: root_password
        options: >-
          --health-cmd="mysqladmin ping -h 127.0.0.1 -P 3306 -u root -proot_password"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=10
        ports:
          - 3306:3306

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js with Cache
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"
          cache: 'npm'
          cache-dependency-path: |
            frontend/package.json
            e2e/package.json

      - name: Setup Python with Cache
        uses: actions/setup-python@v4
        with:
          python-version: "3.11"
          cache: 'pip'
          cache-dependency-path: backend/requirements/base.txt

      - name: Download Frontend Dependencies
        uses: actions/download-artifact@v4
        with:
          name: frontend-node-modules
          path: frontend/node_modules

      - name: Download E2E Dependencies
        uses: actions/download-artifact@v4
        with:
          name: e2e-node-modules
          path: e2e/node_modules
        continue-on-error: true

      - name: Configure China Mirrors
        uses: ./.github/actions/configure-china-mirrors

      - name: Install Backend Dependencies
        working-directory: ./backend
        run: |
          echo "ğŸ å®‰è£…åç«¯ä¾èµ–..."
          pip install --upgrade pip
          pip install -r requirements/base.txt
          pip install -r requirements/test.txt

      - name: Install Playwright Browsers
        working-directory: ./e2e
        run: |
          echo "ğŸ­ å®‰è£…Playwrightæµè§ˆå™¨..."
          npx playwright install --with-deps
          echo "âœ… Playwrightæµè§ˆå™¨å®‰è£…å®Œæˆ"

      - name: Build Frontend for E2E
        working-directory: ./frontend
        run: |
          echo "ğŸ—ï¸ æ„å»ºå‰ç«¯ç”¨äºE2Eæµ‹è¯•..."
          echo "ğŸ” æ£€æŸ¥å‰ç«¯ä¾èµ–..."
          if [ ! -d "node_modules" ] || [ ! -f "node_modules/.bin/vite" ]; then
            echo "ğŸ“¦ é‡æ–°å®‰è£…å‰ç«¯ä¾èµ–..."
            npm ci --prefer-offline --no-audit --ignore-scripts
          fi
          npm run build:skip-check || npm run build
          echo "âœ… å‰ç«¯æ„å»ºå®Œæˆ"

      - name: Start Backend Server
        working-directory: ./backend
        run: |
          echo "ğŸš€ å¯åŠ¨åç«¯æœåŠ¡å™¨..."
          python manage.py runserver 8000 &
          echo $! > backend.pid
          echo "âœ… åç«¯æœåŠ¡å™¨å·²å¯åŠ¨"
        env:
          DATABASE_URL: mysql://bravo_user:bravo_password@mysql:3306/bravo_test
          DJANGO_SETTINGS_MODULE: bravo.settings.test

      - name: Start Frontend Server
        working-directory: ./frontend
        run: |
          echo "ğŸŒ å¯åŠ¨å‰ç«¯æœåŠ¡å™¨..."
          cd dist
          python3 -m http.server 3001 &
          echo $! > ../frontend.pid
          cd ..
          echo "âœ… å‰ç«¯æœåŠ¡å™¨å·²å¯åŠ¨"

      - name: Run E2E Tests with Optimization
        working-directory: ./e2e
        run: |
          echo "ğŸ§ª è¿è¡ŒE2Eæµ‹è¯•ï¼ˆä¼˜åŒ–ç‰ˆï¼‰..."
          echo "ğŸ” æ£€æŸ¥node_modulesæ˜¯å¦å­˜åœ¨..."
          if [ ! -d "node_modules" ] || [ ! -f "node_modules/.bin/playwright" ]; then
            echo "ğŸ“¦ é‡æ–°å®‰è£…E2Eä¾èµ–..."
            npm install --prefer-offline --no-audit --ignore-scripts
          fi
          npx playwright test --workers=2 --max-failures=5 --trace=retain-on-failure --reporter=html --reporter=junit
          echo "âœ… E2Eæµ‹è¯•å®Œæˆ"
        env:
          PLAYWRIGHT_JUNIT_OUTPUT_NAME: e2e-results.xml

      - name: Upload E2E Test Results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: e2e-test-results
          path: |
            e2e/test-results/
            e2e/playwright-report/
          retention-days: 7

      - name: Cleanup Servers
        if: always()
        run: |
          echo "ğŸ§¹ æ¸…ç†æœåŠ¡å™¨è¿›ç¨‹..."
          [ -f backend/backend.pid ] && kill $(cat backend/backend.pid) 2>/dev/null || true
          [ -f frontend/frontend.pid ] && kill $(cat frontend/frontend.pid) 2>/dev/null || true
          echo "âœ… æœåŠ¡å™¨è¿›ç¨‹å·²æ¸…ç†"

  # ==========================================
  # Job 5: æ€§èƒ½æµ‹è¯• (Performance Tests)
  # ==========================================
  performance-tests:
    needs: [setup-dependencies, frontend-tests]
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js with Cache
        uses: actions/setup-node@v4
        with:
          node-version: "20.x"
          cache: 'npm'
          cache-dependency-path: frontend/package.json

      - name: Download Frontend Dependencies
        uses: actions/download-artifact@v4
        with:
          name: frontend-node-modules
          path: frontend/node_modules

      - name: Configure China Mirrors
        uses: ./.github/actions/configure-china-mirrors

      - name: Build Frontend for Performance Testing
        working-directory: ./frontend
        run: |
          echo "ğŸ—ï¸ æ„å»ºå‰ç«¯ç”¨äºæ€§èƒ½æµ‹è¯•..."
          echo "ğŸ” æ£€æŸ¥å‰ç«¯ä¾èµ–..."
          if [ ! -d "node_modules" ] || [ ! -f "node_modules/.bin/vite" ]; then
            echo "ğŸ“¦ é‡æ–°å®‰è£…å‰ç«¯ä¾èµ–..."
            npm ci --prefer-offline --no-audit --ignore-scripts
          fi
          npm run build:skip-check || npm run build
          echo "âœ… å‰ç«¯æ„å»ºå®Œæˆ"

      - name: Run Lighthouse Performance Tests
        run: |
          echo "âš¡ è¿è¡ŒLighthouseæ€§èƒ½æµ‹è¯•..."
          npm install -g @lhci/cli
          
          # å¯åŠ¨å‰ç«¯æœåŠ¡å™¨
          cd frontend/dist
          python3 -m http.server 3001 &
          FRONTEND_PID=$!
          cd ../..
          
          # ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
          echo "ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨..."
          for i in {1..30}; do
            if curl -f -s http://localhost:3001 > /dev/null 2>&1; then
              echo "âœ… å‰ç«¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ"
              sleep 3
              break
            fi
            echo "ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨... (attempt $i/30)"
            sleep 2
          done
          
          # è¿è¡ŒLighthouse CI
          if lhci autorun --config=lighthouserc.json; then
            echo "âœ… Lighthouse CI æˆåŠŸå®Œæˆ"
          else
            echo "âš ï¸ Lighthouse CI å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ³•..."
            lhci autorun --config=lighthouserc-simple.json || echo "âŒ ç®€å•é…ç½®å¤±è´¥"
          fi
          
          # æ¸…ç†è¿›ç¨‹
          kill $FRONTEND_PID 2>/dev/null || true
          echo "âœ… æ€§èƒ½æµ‹è¯•å®Œæˆ"

      - name: Upload Performance Test Results
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: performance-test-results
          path: |
            .lighthouseci/
            lighthouse-*.html
          retention-days: 7

  # ==========================================
  # Job 6: æ±‡æ€»å’ŒæŠ¥å‘Š (Summary & Reporting)
  # ==========================================
  final-summary:
    needs: [frontend-tests, backend-tests, e2e-tests, performance-tests]
    runs-on: ubuntu-latest
    if: always()

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Download All Test Results
        uses: actions/download-artifact@v4
        with:
          path: all-test-results

      - name: Generate Test Summary
        run: |
          echo "ğŸ“Š ç”Ÿæˆæµ‹è¯•æ±‡æ€»æŠ¥å‘Š..."
          
          echo "## ğŸš€ Gate Pipeline æµ‹è¯•æ±‡æ€»" > test-summary.md
          echo "" >> test-summary.md
          echo "### ğŸ“ˆ Jobs æ‰§è¡ŒçŠ¶æ€" >> test-summary.md
          echo "- å‰ç«¯æµ‹è¯•: ${{ needs.frontend-tests.result }}" >> test-summary.md
          echo "- åç«¯æµ‹è¯•: ${{ needs.backend-tests.result }}" >> test-summary.md
          echo "- E2Eæµ‹è¯•: ${{ needs.e2e-tests.result }}" >> test-summary.md
          echo "- æ€§èƒ½æµ‹è¯•: ${{ needs.performance-tests.result }}" >> test-summary.md
          echo "" >> test-summary.md
          
          # æ£€æŸ¥è¦†ç›–ç‡æ–‡ä»¶
          if [ -f "all-test-results/frontend-test-results/coverage-frontend.lcov" ]; then
            echo "âœ… å‰ç«¯è¦†ç›–ç‡æŠ¥å‘Šå·²ç”Ÿæˆ"
          fi
          
          if [ -f "all-test-results/backend-test-results/coverage-backend.xml" ]; then
            echo "âœ… åç«¯è¦†ç›–ç‡æŠ¥å‘Šå·²ç”Ÿæˆ"
          fi
          
          echo "âœ… æµ‹è¯•æ±‡æ€»æŠ¥å‘Šç”Ÿæˆå®Œæˆ"

      - name: Upload Coverage to Codecov
        uses: codecov/codecov-action@v3
        with:
          token: ${{ secrets.CODECOV_TOKEN }}
          files: |
            all-test-results/frontend-test-results/coverage-frontend.lcov
            all-test-results/backend-test-results/coverage-backend.xml
          flags: unittests
          name: codecov-umbrella
          fail_ci_if_error: false

      - name: Upload Final Summary
        uses: actions/upload-artifact@v4
        with:
          name: final-test-summary
          path: |
            test-summary.md
            all-test-results/
          retention-days: 30

      - name: Check Overall Status
        run: |
          echo "ğŸ¯ æ£€æŸ¥æ•´ä½“æµ‹è¯•çŠ¶æ€..."
          
          FRONTEND_STATUS="${{ needs.frontend-tests.result }}"
          BACKEND_STATUS="${{ needs.backend-tests.result }}"
          E2E_STATUS="${{ needs.e2e-tests.result }}"
          PERFORMANCE_STATUS="${{ needs.performance-tests.result }}"
          
          echo "å‰ç«¯æµ‹è¯•: $FRONTEND_STATUS"
          echo "åç«¯æµ‹è¯•: $BACKEND_STATUS" 
          echo "E2Eæµ‹è¯•: $E2E_STATUS"
          echo "æ€§èƒ½æµ‹è¯•: $PERFORMANCE_STATUS"
          
          if [[ "$FRONTEND_STATUS" == "success" && "$BACKEND_STATUS" == "success" && "$E2E_STATUS" == "success" ]]; then
            echo "ğŸ‰ æ‰€æœ‰æ ¸å¿ƒæµ‹è¯•é€šè¿‡ï¼Gateæ£€æŸ¥æˆåŠŸï¼"
            exit 0
          else
            echo "âŒ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼ŒGateæ£€æŸ¥æœªé€šè¿‡"
            exit 1
          fi