---
description: Task-Master生成任务阶段的规则
globs: .taskmaster/**/*.json, .taskmaster/**/*.md
priority: 800
---

# 任务生成规范

## 1. 工作流指令
1. **解析**: `task-master parse-prd <prd-file> --tag <tag-name>`。
2. **展开**: `task-master expand --all --research` (复杂度 ≥ 8 必须展开)。
3. **自核**: `task-master show <task_id>` 检查关联的 REQ-ID。

## 2. Task-0 强制任务 (自检)
每个 PRD 的第一个任务必须是 **Task-0**，其子任务固定为：
- [ ] 验证 PRD 元数据与技术细节完整性。
- [ ] 检查测试目录结构与 API 契约文件是否存在。
- [ ] 验证数据库设计是否包含索引与约束。

## 3. 任务组织原则
- **TDD 嵌入**: 每个功能任务必须包含 `[测试-红]`, `[实现-绿]`, `[重构]` 三个子任务。
- **依赖序向**: 数据库 → 后端 API → 前端 UI。
- **容器化**: 任务描述中必须指明使用的 `docker-compose exec` 命令。

## 4. 自动化建议
- 优先使用 `bash scripts/task-master-parse-prd.sh`，该脚本会自动生成 Task-0 并更新 PRD 状态。

---

## 规则应用声明
当AI被路由到此规则时，必须在响应开头明确声明：

```
[应用规则：@.cursor/rules/03-taskmaster/task-generation.mdc]
```
