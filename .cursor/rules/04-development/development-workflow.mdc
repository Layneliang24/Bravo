---
description: 开发阶段的代码实现规则
globs: backend/apps/**/*.py, frontend/src/**/*.{ts,tsx,vue,js,jsx}
priority: 750
---

# 开发阶段规则

## 1. 核心职责
- **驱动方式**: 依据测试文件实现功能（TDD：红 → 绿 → 重构）。
- **契约守卫**: API 实现必须 100% 匹配 OpenAPI 契约（详见 @contract-testing.mdc）。
- **追溯要求**: 所有新文件必须包含 REQ-ID 注释（格式见 @v4-traceability.mdc）。

## 2. 环境与工具约束
- **容器化执行**: 严禁宿主机操作。所有开发、构建、测试指令必须通过 `docker-compose exec` 运行（详见 @v4-containerization.mdc）。
- **质量检查**: 提交前必须执行后端 (Black/Isort/Flake8/Mypy) 和前端 (Lint/Type-check) 检查。

## 3. 渐进式开发原则
- **利用已有成果**: 优先在现有模型和模式上扩展。
- **一致性自核**:
  - [ ] 是否复用了现有的 User/Base 模型？
  - [ ] 目录结构和命名是否符合现有习惯？
  - [ ] API 响应格式是否与项目已有接口统一？

## 4. 浏览器环境验证 (强制性)
> [!IMPORTANT]
> 容器内测试通过不代表浏览器运行正常。修复前端问题后必须执行以下验证：

- **验证步骤**:
  1. 使用 `browser_navigate` 访问 `http://localhost:3000`。
  2. 使用 `browser_console_messages` 检查是否有 `CORS` 或 `404/500` 错误。
  3. 使用 `browser_network_requests` 确认 API 交互状态。
- **关键差异**: 验证宿主机访问 API (localhost) 时的跨域配置。

## 5. 原子禁令
- ❌ 严禁跳过 TDD 流程编写业务代码。
- ❌ 严禁在没有测试通行证的情况下提交。
- ❌ 严禁实现 PRD/契约之外的“聪明功能”。

---

## 规则应用声明
当AI被路由到此规则时，必须在响应开头明确声明：

```
[应用规则：@.cursor/rules/04-development/development-workflow.mdc]
[切换到开发专家角色]
```
