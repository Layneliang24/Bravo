---
description: 根据用户意图动态路由至对应工作流规则
globs: **/*
alwaysApply: true
priority: 980
---

# 意图路由层 (Router)

> **核心原则**：基于对话内容激活规则，不受当前打开文件限制，并基于实时会话内容动态加载规则。

## 1. 响应规范 (Mandatory)

识别意图后，**必须**按以下格式声明：

```
[识别意图：{类型} - {具体请求}]
   [应用规则：@.cursor/rules/00-core/intent-recognition.mdc]
[路由规则（需阅读并声明）：加载 @.cursor/rules/... 等]
[切换角色：{角色名}]
[开始执行：{操作内容}]
```

## 2. 意图映射表 (Mapping Table)

| 意图类型 | 触发关键词 (包含匹配) | 核心加载规则 (.cursor/rules/) | 切换角色 |
| :--- | :--- | :--- | :--- |
| **PRD** | PRD, 需求, 分析PRD, 精化 | 01-product/prd-standards.mdc, 01-product/prd-refinement.mdc | PRD设计专家 |
| **任务** | 生成任务, Task-Master, parse-prd | 03-taskmaster/task-generation.mdc, 03-taskmaster/hamster-integration.mdc | 任务专家 |
| **开发** | 实现, 编码, Task-X, Django, Vue | 04-development/development-workflow.mdc, 00-core/v4-directory-structure.mdc | 开发专家 |
| **测试** | 测试, unit test, E2E, TDD, 覆盖率 | 02-testing/test-types.mdc, 02-testing/test-case-standards.mdc, 00-core/v4-tdd.mdc | 测试专家 |
| **测试用例评审** | 测试用例评审, 评审测试用例, test case review | 02-testing/test-case-review.mdc, 02-testing/test-case-standards.mdc | 测试专家 |
| **提交/推送** | commit, push, 提交, safe-push | 06-cicd/version-control.mdc, 06-cicd/pre-commit.mdc, v4-traceability.mdc | (流程执行) |
| **调试** | 调试, 排查, fix bug, 报错 | 05-debugging/debugging-methodology.mdc, troubleshooting-checklist.mdc | (流程执行) |
| **API契约** | API契约, OpenAPI, 设计API | 02-testing/contract-testing.mdc, 09-roles/architect.mdc | 架构专家 |
| **文档/代码审查** | 文档维护, review, 审查代码 | 07-documentation/documentation-standards.mdc, 10-quality/code-review.mdc | (流程执行) |
| **架构/启动** | 架构, 系统设计, setup, init | 09-roles/architect.mdc, 08-project/project-setup.mdc, v4-core.mdc | 架构专家 |
| **优化/安全/部署** | 性能, performance, 安全检查, 部署 | 10-quality/performance.mdc, 10-quality/security.mdc, 06-cicd/cd-workflow.mdc | (流程执行) |

## 3. 路由逻辑指令

1.  **组合意图**：若涉及多项（如“开发+测试”），必须加载所有相关规则并合并角色。
2.  **降级策略**：
    -   1. 上下文推断（如：正在进行的 PRD 讨论）。
    -   2. 文件类型匹配（Globs）。
    -   3. 通用规则应用并询问用户确认。
3.  **强制阅读**：路由到的规则会在末尾要求声明，AI **必须** 阅读并执行该声明。
